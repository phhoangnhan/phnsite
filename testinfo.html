


<!DOCTYPE html>
<html>
<head>
  <title>Tra cứu & Cập nhật Google Sheet</title>
</head>
<body>
  <h2>TRA CỨU DỮ LIỆU</h2>
  <input type="text" id="searchValue" placeholder="Nhập Mã (cột A)">
  <button onclick="getData()">Tra cứu</button>

  <h2>KẾT QUẢ</h2>
  <label>Tên:</label><input type="text" id="ten"><br>
  <label>Tuổi:</label><input type="text" id="tuoi"><br>
  <label>Email:</label><input type="text" id="email"><br>
  <input type="hidden" id="rowIndex">
  <p id="result"></p>
  <button onclick="updateData()">Cập nhật dòng này</button>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbxX4IFOKittCUatLfVwdTSNTDI3mGPOzUjbgMiBtCwj-m6-bVXJgkaQ0OIKX4oKgD6NTw/exec";

    function getData() {
      const value = document.getElementById("searchValue").value;
      fetch(`${API_URL}?value=${encodeURIComponent(value)}`)
        .then(res => res.text())
        .then(text => {
          try {
            const data = JSON.parse(text);
            document.getElementById("ten").value = data["name"] || "";
            document.getElementById("tuoi").value = data["phone"] || "";
            document.getElementById("email").value = data["email"] || "";
            document.getElementById("rowIndex").value = data["rowIndex"];
            document.getElementById("result").textContent = "✅ Đã tìm thấy";
          } catch {
            document.getElementById("result").textContent = "❌ Không tìm thấy";
          }
        })
        .catch(err => {
          document.getElementById("result").textContent = "Lỗi: " + err;
        });
    }

    function updateData() {
      const payload = {
        name: document.getElementById("ten").value,
        phone: document.getElementById("tuoi").value,
        email: document.getElementById("email").value,
        rowIndex: document.getElementById("rowIndex").value
      };

      fetch(API_URL, {
        method: "POST",

        body: JSON.stringify(payload),
        headers: { "Content-Type": "application/json" }
      })
        .then(res => res.text())
        .then(text => {
          document.getElementById("result").textContent = text;
        })
        .catch(err => {
          document.getElementById("result").textContent = "Lỗi: " + err;
        });
    }
  </script>
</body>
</html>